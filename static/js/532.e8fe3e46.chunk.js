"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[532],{6492:function(e,s,t){t.r(s),t.d(s,{default:function(){return De}});var r=t(5671),a=t(3144),o=t(136),n=t(7277),i=t(2791),l=t(8281),d=t(8687),c=t(7781),u=t(1852),p="UserListMessages_usersListMessagesFixed__n95Kp",g="UserListMessages_setDesktop__mYjrO",m="UserListMessages_setMobile__RZGLB",h="UserListMessages_usersListCommonFixed__lwndY",f="UserListMessages_MessagesCommonFixed__T4G57",v="UserListMessages_userPhoto__iRPSv",x="UserListMessages_messagesHeaderFixed__v6Hxk",_="UserListMessages_messagesMiddleFixed__MWdHU",j="UserListMessages_messagesFooterFixed__kCMoI",M="UserListMessages_myLink__-Xnne",y=t(6110),I="Message_messagesCommon__WS2pF",Z="Message_messageMyId__+mbtn",b="Message_messageNotMyId__5+CvR",T="Message_insideToastMy__P6sDI",L="Message_insideToastNotMy__meNqg",k="Message_time__4GQ5r",D="Message_closeButton__OGOB3",C="Message_placeholder__SqINF",N=t(1413),U=t(5987),P=t(1694),w=t.n(P),F=t(5746),B=t(1683),H=Math.pow(2,31)-1;function R(e,s,t){var r=t-Date.now();e.current=r<=H?setTimeout(s,r):setTimeout((function(){return R(e,s,t)}),H)}function W(){var e=(0,F.Z)(),s=(0,i.useRef)();return(0,B.Z)((function(){return clearTimeout(s.current)})),(0,i.useMemo)((function(){var t=function(){return clearTimeout(s.current)};return{set:function(r,a){void 0===a&&(a=0),e()&&(t(),a<=H?s.current=setTimeout(r,a):R(s,r,Date.now()+a))},clear:t}}),[])}var A,E=t(4942),$=t(5090),O=t(2709),S=t(184),q=(A={},(0,E.Z)(A,$.d0,"showing"),(0,E.Z)(A,$.Ix,"showing show"),A),G=i.forwardRef((function(e,s){return(0,S.jsx)(O.Z,(0,N.Z)((0,N.Z)({},e),{},{ref:s,transitionClasses:q}))}));G.displayName="ToastFade";var Q=G,V=t(9007),J=t(162),Y=t(473),z=i.createContext({onClose:function(){}}),K=["bsPrefix","closeLabel","closeVariant","closeButton","className","children"],X=i.forwardRef((function(e,s){var t=e.bsPrefix,r=e.closeLabel,a=e.closeVariant,o=e.closeButton,n=e.className,l=e.children,d=(0,U.Z)(e,K);t=(0,J.vE)(t,"toast-header");var c=(0,i.useContext)(z),u=(0,V.Z)((function(e){null==c||null==c.onClose||c.onClose(e)}));return(0,S.jsxs)("div",(0,N.Z)((0,N.Z)({ref:s},d),{},{className:w()(t,n),children:[l,o&&(0,S.jsx)(Y.Z,{"aria-label":r,variant:a,onClick:u,"data-dismiss":"toast"})]}))}));X.displayName="ToastHeader",X.defaultProps={closeLabel:"Close",closeButton:!0};var ee=X,se=(0,t(6543).Z)("toast-body"),te=["bsPrefix","className","transition","show","animation","delay","autohide","onClose","bg"],re=i.forwardRef((function(e,s){var t=e.bsPrefix,r=e.className,a=e.transition,o=void 0===a?Q:a,n=e.show,l=void 0===n||n,d=e.animation,c=void 0===d||d,u=e.delay,p=void 0===u?5e3:u,g=e.autohide,m=void 0!==g&&g,h=e.onClose,f=e.bg,v=(0,U.Z)(e,te);t=(0,J.vE)(t,"toast");var x=(0,i.useRef)(p),_=(0,i.useRef)(h);(0,i.useEffect)((function(){x.current=p,_.current=h}),[p,h]);var j=W(),M=!(!m||!l),y=(0,i.useCallback)((function(){M&&(null==_.current||_.current())}),[M]);(0,i.useEffect)((function(){j.set(y,x.current)}),[j,y]);var I=(0,i.useMemo)((function(){return{onClose:h}}),[h]),Z=!(!o||!c),b=(0,S.jsx)("div",(0,N.Z)((0,N.Z)({},v),{},{ref:s,className:w()(t,r,f&&"bg-".concat(f),!Z&&(l?"show":"hide")),role:"alert","aria-live":"assertive","aria-atomic":"true"}));return(0,S.jsx)(z.Provider,{value:I,children:Z&&o?(0,S.jsx)(o,{in:l,unmountOnExit:!0,children:b}):b})}));re.displayName="Toast";var ae=Object.assign(re,{Body:se,Header:ee}),oe=function(e){var s=e.message,t=e.myId,r=e.userId,a=e.Date,o=e.MessageId,n=e.deleteMessage;return(0,S.jsx)("div",{children:(0,S.jsx)("div",{className:"".concat(I," ").concat(t===r?Z:b),children:(0,S.jsx)(ae,{className:t===r?T:L,children:(0,S.jsx)(ae.Body,{children:(0,S.jsxs)("div",{className:"d-flex d-inline-block",children:[" ",(0,S.jsxs)("big",{children:[s," "]}),(0,S.jsxs)("div",{className:k,children:[("0"+a.Hour).substr(-2),":",("0"+a.Minutes).substr(-2)]}),(0,S.jsx)("div",{className:C})," ",(0,S.jsx)(Y.Z,{className:D,onClick:function(){n(o)}})]})})})})})},ne=function(e){var s=e.messages2,t=e.myId,r=e.deleteMessage;return(0,S.jsx)("div",{children:null!==s&&s.map((function(e){return(0,S.jsx)(oe,{message:e.message,myId:t,userId:e.userId,Date:e.Date,MessageId:e.id,deleteMessage:r},e.id+e.message)}))})},ie=t(5705),le=t(1724),de=t(6670),ce=t(3360),ue=t(2592);var pe=t.p+"static/media/send-svg2.12d8e771d6d27bcd4485de69966afd04.svg",ge="MessagesFormik_sendSwg__bjMJ-",me={newMessage:""},he=le.Ry({}),fe=function(e){var s=e.sendMessage,t=e.scrollBottom;return(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(ie.J9,{initialValues:me,validationSchema:he,onSubmit:function(e,t){var r=t.resetForm;s(e.newMessage),r()},children:function(e){e.handleReset;var s=e.values;return(0,S.jsx)(ie.l0,{children:(0,S.jsxs)("div",{className:"d-flex d-inline-block justify-content-center align-items-center",children:[(0,S.jsx)("div",{className:"col-9",children:(0,S.jsx)(de.rZ,{label:"",autoFocus:!0,name:"newMessage",type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u0448\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",leftLabelLength:""})}),(0,S.jsx)("div",{children:(0,S.jsx)(ce.Z,{variant:"light",className:"mx-2",type:"submit",onClick:t,disabled:!s.newMessage,children:(0,S.jsx)(ue.Z,{src:pe,className:ge,alt:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",title:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435"})})})]})})}})})},ve=t(1087),xe=t(205),_e=function(e){var s=e.messages2,t=e.myId,r=e.deleteMessage,a=e.sendMessage,o=e.scrollBottom,n=e.profile,i=e.patch,l=e.PageWidth,d=(0,S.jsx)("div",{children:n&&(0,S.jsxs)(ve.OL,{to:"/profile/".concat(n.userId),className:M,children:[(0,S.jsx)(ue.Z,{src:n.photos.small?n.photos.small:y,className:v,title:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u043f\u0440\u043e\u0444\u0438\u043b\u044c",alt:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u043f\u0440\u043e\u0444\u0438\u043b\u044c"}),(0,S.jsx)("span",{children:n.fullName})]})}),c="dialogs"===i&&l<620;return(0,S.jsxs)("div",{className:"".concat(p," ").concat(c?m:g),children:[!c&&(0,S.jsx)("div",{className:h,children:(0,S.jsx)(xe.default,{})})," ",(0,S.jsxs)("div",{className:f,children:[(0,S.jsx)("div",{className:x,children:d}),(0,S.jsxs)("div",{className:_,children:[(0,S.jsx)(ne,{messages2:s,myId:t,deleteMessage:r}),(0,S.jsx)("div",{className:j,children:(0,S.jsx)(fe,{sendMessage:a,scrollBottom:o})})]})]})]})},je=function(){var e=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight);window.scrollTo(0,e)},Me=function(e){(0,o.Z)(t,e);var s=(0,n.Z)(t);function t(){var e;(0,r.Z)(this,t);for(var a=arguments.length,o=new Array(a),n=0;n<a;n++)o[n]=arguments[n];return(e=s.call.apply(s,[this].concat(o))).sendMessage=function(s){if(e.props.userId){if(s){var t=e.props.profile?e.props.profile.fullName:"",r=e.props.profile?e.props.profile.photos.small:"",a=e.props.myProfile?e.props.myProfile.photos.small:"";e.props.sendDialogsThunkCreator(s,e.props.myId,e.props.myLogin,a,e.props.userId),e.props.updateDialogListThunkCreator(e.props.myId,e.props.userId,t,r)}}else alert("\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0438\u0430\u043b\u043e\u0433")},e.deleteMessage=function(s){e.props.deleteMessageThunkCreator(s,e.props.myId,e.props.userId)},e.scrollBottom=function(){je()},e}return(0,a.Z)(t,[{key:"render",value:function(){return(0,S.jsx)("div",{children:(0,S.jsx)(_e,{messages2:this.props.messages2,myId:this.props.myId,deleteMessage:this.deleteMessage,sendMessage:this.sendMessage,scrollBottom:this.scrollBottom,profile:this.props.profile,patch:this.props.patch,PageWidth:this.props.PageWidth})})}}]),t}(i.Component),ye=(0,c.qC)((0,d.$j)((function(e){return{myId:e.auth.myId,myLogin:e.auth.myLogin,myProfile:e.auth.myProfile,dialogUserID:e.dialogsPage.dialogUserID,messages2:e.dialogsPage.messages2,profile:e.profilePage.profile,profilePage:e.profilePage,patch:e.app.patch,PageWidth:e.app.PageWidth}}),{sendDialogsThunkCreator:l.nB,deleteMessageThunkCreator:l.EF,updateDialogListThunkCreator:l.wB}),u.Z)(Me),Ie=function(e){var s=e.getDialogList,t=e.getDialogLastUpdateTime;return(0,i.useEffect)((function(){var e=setInterval((function(){t(),s()}),1e3);return function(){clearInterval(e)}}),[t,s]),(0,S.jsx)(ye,{})},Ze=t(81),be=t(3990),Te=l.Qd.setdialogUserID,Le=l.Qd.setMessages,ke=function(e){(0,o.Z)(t,e);var s=(0,n.Z)(t);function t(){var e;(0,r.Z)(this,t);for(var a=arguments.length,o=new Array(a),n=0;n<a;n++)o[n]=arguments[n];return(e=s.call.apply(s,[this].concat(o))).commonPartMountUpdate=function(){e.props.userId?e.props.dialogUserID!==e.props.userId&&(e.props.setdialogUserID(e.props.userId),e.props.getProfileThunkCreator(e.props.userId,!0,e.props.myId)):e.props.messages2&&e.props.messages2.length>0&&(e.props.setMessages([]),e.props.setdialogUserID(0))},e.getDialogs=function(){0!==e.props.userId&&e.props.getDialogsThunkCreator(e.props.myId,e.props.userId)},e.getDialogLastUpdateTime=function(){0!==e.props.userId&&e.props.getDialogLastUpdateTimeTnkCrt(e.props.myId,e.props.userId)},e.getDialogList=function(){e.props.getMyDialogListThunkCreator(e.props.myId)},e.deleteDialog=function(s,t){e.props.deleteDialogThunkCreator(s,e.props.myId,t)},e}return(0,a.Z)(t,[{key:"componentDidMount",value:function(){this.getDialogList(),this.commonPartMountUpdate()}},{key:"componentDidUpdate",value:function(e){this.commonPartMountUpdate(),this.props.dialogLastUpdateTime!==e.dialogLastUpdateTime&&this.getDialogs()}},{key:"render",value:function(){return(0,S.jsx)("div",{children:(0,S.jsx)(Ie,{getDialogLastUpdateTime:this.getDialogLastUpdateTime,getDialogList:this.getDialogList})})}}]),t}(i.Component),De=(0,c.qC)((0,d.$j)((function(e){return{myId:e.auth.myId,dialogUserID:e.dialogsPage.dialogUserID,messages2:e.dialogsPage.messages2,dialogLastUpdateTime:e.dialogsPage.dialogLastUpdateTime}}),{getDialogsThunkCreator:l.kp,setdialogUserID:Te,setMessages:Le,getDialogLastUpdateTimeTnkCrt:l.kB,getProfileThunkCreator:Ze.aI,getMyDialogListThunkCreator:l.l,deleteDialogThunkCreator:l.LZ}),u.Z,be.Z)(ke)},6670:function(e,s,t){t.d(s,{$m:function(){return f},rZ:function(){return h}});var r=t(1413),a=t(9439),o=t(5987),n=t(5705),i={errorInputTextArea:"formik1_errorInputTextArea__vpmAv",errorText:"formik1_errorText__eDWui",labelWidth:"formik1_labelWidth__cwal9"},l=(t(7632),t(9410)),d=t(5313),c=t(184),u=["label","children"],p=["label","autoFocus","type","leftLabelLength"],g=["children"],m=function(e){e.label;var s=e.children,t=(0,o.Z)(e,u),r=(0,n.U$)(t.props),l=(0,a.Z)(r,1)[0];return(0,c.jsxs)(c.Fragment,{children:[s," ",l.touched&&l.error&&(0,c.jsx)("div",{className:i.errorText,children:l.error})," "]})},h=function(e){var s=e.label,t=e.autoFocus,u=e.type,g=e.leftLabelLength,h=(0,o.Z)(e,p),f=(0,n.U$)(h),v=(0,a.Z)(f,2),x=v[0],_=v[1];return(0,c.jsxs)(m,{label:s,props:h,children:[" ",(0,c.jsxs)(l.Z,{className:"my-1",size:"sm",children:[" ",g&&(0,c.jsxs)(l.Z.Text,{id:s,className:i.labelWidth,style:{width:g},children:[s,":"]}),(0,c.jsx)(d.Z.Control,(0,r.Z)((0,r.Z)((0,r.Z)({as:"textarea"===u?u:"input",type:"password"===u?u:void 0,className:_.touched&&_.error?i.errorInputTextArea:i.inputTextArea},x),h),{},{autoFocus:t}))]}),(0,c.jsx)("div",{className:i.errorText,children:_.touched&&_.error})]})},f=function(e){var s=e.children,t=(0,o.Z)(e,g),l=(0,n.U$)((0,r.Z)((0,r.Z)({},t),{},{type:"checkbox"})),d=(0,a.Z)(l,2),u=d[0],p=d[1];return(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{className:"checkbox-input",children:[(0,c.jsx)("input",(0,r.Z)((0,r.Z)({type:"checkbox"},u),t))," ",s]}),p.touched&&p.error&&(0,c.jsx)("div",{className:i.errorText,children:p.error})]})}},3990:function(e,s,t){var r=t(1413),a=(t(2791),t(8687)),o=t(7689),n=t(184),i=function(e){return{isAuth:e.auth.isAuth}};s.Z=function(e){return(0,a.$j)(i,null)((function(s){return s.isAuth?(0,n.jsx)(e,(0,r.Z)({},s)):(0,n.jsx)(o.Fg,{to:"../login"})}))}},1852:function(e,s,t){var r=t(1413),a=(t(2791),t(7689)),o=t(8687),n=t(184);s.Z=function(e){return(0,o.$j)(null,null)((function(s){var t={params:(0,a.UO)()},o=Number(t.params["*"]);return(0,n.jsx)(e,(0,r.Z)((0,r.Z)({},s),{},{userId:o}))}))}}}]);
//# sourceMappingURL=532.e8fe3e46.chunk.js.map