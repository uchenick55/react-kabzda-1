"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[402],{4402:function(e,s,t){t.r(s),t.d(s,{default:function(){return De}});var a=t(5671),o=t(3144),r=t(136),n=t(7277),i=t(2791),l=t(8281),d=t(8687),u=t(7781),c=t(1852),g="DialogList_BgStyle__bQObV",p="DialogList_photoFixed__u4+AK",m="DialogList_inputFixed__qlqSC",f="DialogList_userPhoto__Gv9DW",h="DialogList_myLink__5+Icu",v=t(6110),x="Message_messagesCommon__WS2pF",y="Message_messageMyId__+mbtn",I="Message_messageNotMyId__5+CvR",D="Message_insideToastMy__P6sDI",M="Message_insideToastNotMy__meNqg",j="Message_time__4GQ5r",_="Message_closeButton__OGOB3",C=t(1413),T=t(5987),Z=t(1694),k=t.n(Z),L=t(5746),b=t(1683),N=Math.pow(2,31)-1;function P(e,s,t){var a=t-Date.now();e.current=a<=N?setTimeout(s,a):setTimeout((function(){return P(e,s,t)}),N)}function w(){var e=(0,L.Z)(),s=(0,i.useRef)();return(0,b.Z)((function(){return clearTimeout(s.current)})),(0,i.useMemo)((function(){var t=function(){return clearTimeout(s.current)};return{set:function(a,o){void 0===o&&(o=0),e()&&(t(),o<=N?s.current=setTimeout(a,o):P(s,a,Date.now()+o))},clear:t}}),[])}var U,B=t(4942),E=t(5090),H=t(2709),R=t(184),F=(U={},(0,B.Z)(U,E.d0,"showing"),(0,B.Z)(U,E.Ix,"showing show"),U),O=i.forwardRef((function(e,s){return(0,R.jsx)(H.Z,(0,C.Z)((0,C.Z)({},e),{},{ref:s,transitionClasses:F}))}));O.displayName="ToastFade";var S=O,q=t(9007),V=t(162),A=t(473),G=i.createContext({onClose:function(){}}),J=["bsPrefix","closeLabel","closeVariant","closeButton","className","children"],Q=i.forwardRef((function(e,s){var t=e.bsPrefix,a=e.closeLabel,o=e.closeVariant,r=e.closeButton,n=e.className,l=e.children,d=(0,T.Z)(e,J);t=(0,V.vE)(t,"toast-header");var u=(0,i.useContext)(G),c=(0,q.Z)((function(e){null==u||null==u.onClose||u.onClose(e)}));return(0,R.jsxs)("div",(0,C.Z)((0,C.Z)({ref:s},d),{},{className:k()(t,n),children:[l,r&&(0,R.jsx)(A.Z,{"aria-label":a,variant:o,onClick:c,"data-dismiss":"toast"})]}))}));Q.displayName="ToastHeader",Q.defaultProps={closeLabel:"Close",closeButton:!0};var W=Q,$=(0,t(6543).Z)("toast-body"),K=["bsPrefix","className","transition","show","animation","delay","autohide","onClose","bg"],z=i.forwardRef((function(e,s){var t=e.bsPrefix,a=e.className,o=e.transition,r=void 0===o?S:o,n=e.show,l=void 0===n||n,d=e.animation,u=void 0===d||d,c=e.delay,g=void 0===c?5e3:c,p=e.autohide,m=void 0!==p&&p,f=e.onClose,h=e.bg,v=(0,T.Z)(e,K);t=(0,V.vE)(t,"toast");var x=(0,i.useRef)(g),y=(0,i.useRef)(f);(0,i.useEffect)((function(){x.current=g,y.current=f}),[g,f]);var I=w(),D=!(!m||!l),M=(0,i.useCallback)((function(){D&&(null==y.current||y.current())}),[D]);(0,i.useEffect)((function(){I.set(M,x.current)}),[I,M]);var j=(0,i.useMemo)((function(){return{onClose:f}}),[f]),_=!(!r||!u),Z=(0,R.jsx)("div",(0,C.Z)((0,C.Z)({},v),{},{ref:s,className:k()(t,a,h&&"bg-".concat(h),!_&&(l?"show":"hide")),role:"alert","aria-live":"assertive","aria-atomic":"true"}));return(0,R.jsx)(G.Provider,{value:j,children:_&&r?(0,R.jsx)(r,{in:l,unmountOnExit:!0,children:Z}):Z})}));z.displayName="Toast";var X=Object.assign(z,{Body:$,Header:W}),Y=function(e){var s=e.message,t=e.myId,a=e.userId,o=e.Date,r=e.MessageId,n=e.deleteMessage;return(0,R.jsx)("div",{children:(0,R.jsx)("div",{className:"".concat(x," ").concat(t===a?y:I),children:(0,R.jsx)(X,{className:t===a?D:M,children:(0,R.jsx)(X.Body,{children:(0,R.jsxs)("div",{className:"d-flex d-inline-block",children:[(0,R.jsxs)("big",{children:[s," "]}),(0,R.jsxs)("div",{className:j,children:[o.Hour,":",o.Minutes]}),(0,R.jsx)(A.Z,{className:_,onClick:function(){n(r)}})]})})})})})},ee=function(e){var s=e.messages2,t=e.myId,a=e.deleteMessage;return s&&s.map((function(e){return(0,R.jsx)(Y,{message:e.message,myId:t,userId:e.userId,Date:e.Date,MessageId:e.id,deleteMessage:a},e.id+e.message)}))},se=t(5705),te=t(1724),ae=t(6670),oe=t(3360),re=t(2592);var ne=t.p+"static/media/send-svg2.12d8e771d6d27bcd4485de69966afd04.svg",ie="Dialog_sendSwg__38Jvm",le={newMessage:""},de=te.Ry({}),ue=function(e){var s=e.sendMessage,t=e.scrollBottom;return(0,R.jsx)(R.Fragment,{children:(0,R.jsx)(se.J9,{initialValues:le,validationSchema:de,onSubmit:function(e,t){var a=t.resetForm;s(e.newMessage),a()},children:function(e){e.handleReset;var s=e.values;return(0,R.jsx)(se.l0,{children:(0,R.jsxs)("div",{className:"d-flex d-inline-block justify-content-center align-items-center",children:[(0,R.jsx)("div",{className:"col-9",children:(0,R.jsx)(ae.rZ,{label:"",name:"newMessage",type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u0448\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435"})}),(0,R.jsx)("div",{children:(0,R.jsx)(oe.Z,{variant:"light",className:"mx-2",type:"submit",onClick:t,disabled:!s.newMessage,children:(0,R.jsx)(re.Z,{src:ne,className:ie,alt:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",title:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435"})})})]})})}})})},ce=t(9743),ge=t(1087),pe=function(e){var s=e.messages2,t=e.myId,a=e.deleteMessage,o=e.sendMessage,r=e.scrollBottom,n=e.profilePage,i=(0,R.jsx)("div",{className:p,children:n.profile&&(0,R.jsxs)(ge.OL,{to:"/profile/".concat(n.profile.userId),className:h,children:[(0,R.jsx)(re.Z,{src:n.profile.photos.small?n.profile.photos.small:v,className:f,title:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u043f\u0440\u043e\u0444\u0438\u043b\u044c",alt:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u043f\u0440\u043e\u0444\u0438\u043b\u044c"}),(0,R.jsx)("span",{children:n.profile.fullName})]})});return(0,R.jsxs)("div",{className:g,children:[(0,R.jsx)(ce.Z,{children:(0,R.jsx)(ee,{messages2:s,myId:t,deleteMessage:a})}),i,(0,R.jsxs)("div",{className:m,children:[" ",(0,R.jsxs)("div",{children:[(0,R.jsx)(ue,{sendMessage:o,scrollBottom:r})," "]})]})]})},me=function(){var e=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight);window.scrollTo(0,e)},fe=function(e){(0,r.Z)(t,e);var s=(0,n.Z)(t);function t(){var e;(0,a.Z)(this,t);for(var o=arguments.length,r=new Array(o),n=0;n<o;n++)r[n]=arguments[n];return(e=s.call.apply(s,[this].concat(r))).sendMessage=function(s){if(e.props.userId){if(s){var t=0,a=0;null!==e.props.profilePage&&(t=e.props.profilePage.profile.fullName,a=e.props.profilePage.profile.photos.small),e.props.sendDialogsThunkCreator(s,e.props.auth.myId,e.props.auth.myLogin,e.props.auth.myProfile.photos.small,e.props.userId),e.props.updateDialogListThunkCreator(e.props.auth.myId,e.props.userId,t,a)}}else alert("\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0438\u0430\u043b\u043e\u0433")},e.deleteMessage=function(s){e.props.deleteMessageThunkCreator(s,e.props.myId,e.props.userId)},e.scrollBottom=function(){return me()},e}return(0,o.Z)(t,[{key:"render",value:function(){return(0,R.jsx)("div",{children:(0,R.jsx)(pe,{messages2:this.props.messages2,myId:this.props.myId,deleteMessage:this.deleteMessage,sendMessage:this.sendMessage,scrollBottom:this.scrollBottom,profilePage:this.props.profilePage})})}}]),t}(i.Component),he=(0,u.qC)((0,d.$j)((function(e){return{myId:e.auth.myId,dialogUserID:e.dialogsPage.dialogUserID,messages2:e.dialogsPage.messages2,profilePage:e.profilePage,auth:e.auth}}),{sendDialogsThunkCreator:l.nB,deleteMessageThunkCreator:l.EF,updateDialogListThunkCreator:l.wB}),c.Z)(fe),ve=function(e){var s=e.getDialogList,t=e.getDialogLastUpdateTime;return(0,i.useEffect)((function(){var e=setInterval((function(){t(),s()}),1e3);return function(){clearInterval(e)}}),[t,s]),(0,R.jsx)(he,{})},xe=t(81),ye=t(3990),Ie=function(e){(0,r.Z)(t,e);var s=(0,n.Z)(t);function t(){var e;(0,a.Z)(this,t);for(var o=arguments.length,r=new Array(o),n=0;n<o;n++)r[n]=arguments[n];return(e=s.call.apply(s,[this].concat(r))).commonPartMountUpdate=function(){e.props.userId?e.props.dialogUserID!==e.props.userId&&(e.props.setdialogUserID(e.props.userId),e.props.getProfileThunkCreator(e.props.userId,!0,e.props.myId)):e.props.messages2&&e.props.messages2.length>0&&(e.props.setMessages([]),e.props.setdialogUserID(0))},e.getDialogs=function(){0!==e.props.userId&&e.props.getDialogsThunkCreator(e.props.myId,e.props.userId)},e.getDialogLastUpdateTime=function(){0!==e.props.userId&&e.props.getDialogLastUpdateTimeTnkCrt(e.props.myId,e.props.userId)},e.getDialogList=function(){e.props.getMyDialogListThunkCreator(e.props.myId)},e.deleteDialog=function(s,t){e.props.deleteDialogThunkCreator(s,e.props.myId,t)},e}return(0,o.Z)(t,[{key:"componentDidMount",value:function(){this.getDialogList(),this.commonPartMountUpdate()}},{key:"componentDidUpdate",value:function(e){this.commonPartMountUpdate(),this.props.dialogLastUpdateTime!==e.dialogLastUpdateTime&&this.getDialogs()}},{key:"render",value:function(){return(0,R.jsx)("div",{children:(0,R.jsx)(ve,{getDialogLastUpdateTime:this.getDialogLastUpdateTime,getDialogList:this.getDialogList})})}}]),t}(i.Component),De=(0,u.qC)((0,d.$j)((function(e){return{myId:e.auth.myId,dialogUserID:e.dialogsPage.dialogUserID,messages2:e.dialogsPage.messages2,dialogLastUpdateTime:e.dialogsPage.dialogLastUpdateTime}}),{getDialogsThunkCreator:l.kp,setdialogUserID:l.Pg,setMessages:l.Z,getDialogLastUpdateTimeTnkCrt:l.kB,getProfileThunkCreator:xe.aI,getMyDialogListThunkCreator:l.l,deleteDialogThunkCreator:l.LZ}),c.Z,ye.Z)(Ie)}}]);
//# sourceMappingURL=402.72e472a8.chunk.js.map