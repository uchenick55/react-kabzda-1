"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[812],{4989:function(e,s,t){t.r(s),t.d(s,{default:function(){return De}});var a=t(1413),o=t(5671),r=t(3144),i=t(136),n=t(7277),l=t(2791),d="DialogList_BgStyle__2iEaj",u="DialogList_inputFixed__xsJy-",c="DialogList_photoFixed__KaeYd",g="DialogList_userPhoto__0CLsE",p="DialogList_linkNoDecoration__hNHxk",m=(t.p,t(2056),t(184)),h=t(6110),f=t(2807),v=t(8687),y=t(7781),x=t(1852),I="Message_messagesCommon__y3ALJ",D="Message_messageMyId__2lyA3",j="Message_messageNotMyId__wlQ5a",M="Message_insideToastMy__uNjRB",_="Message_insideToastNotMy__Z0gRy",Z="Message_time__A+UPN",C="Message_closeButton__YmmdJ",T=t(5987),k=t(1694),L=t.n(k),N=t(5746),P=t(1683),b=Math.pow(2,31)-1;function w(e,s,t){var a=t-Date.now();e.current=a<=b?setTimeout(s,a):setTimeout((function(){return w(e,s,t)}),b)}function U(){var e=(0,N.Z)(),s=(0,l.useRef)();return(0,P.Z)((function(){return clearTimeout(s.current)})),(0,l.useMemo)((function(){var t=function(){return clearTimeout(s.current)};return{set:function(a,o){void 0===o&&(o=0),e()&&(t(),o<=b?s.current=setTimeout(a,o):w(s,a,Date.now()+o))},clear:t}}),[])}var B,E=t(4942),H=t(5090),R=t(2709),F=(B={},(0,E.Z)(B,H.d0,"showing"),(0,E.Z)(B,H.Ix,"showing show"),B),A=l.forwardRef((function(e,s){return(0,m.jsx)(R.Z,(0,a.Z)((0,a.Z)({},e),{},{ref:s,transitionClasses:F}))}));A.displayName="ToastFade";var J=A,S=t(9007),O=t(162),V=t(473),q=l.createContext({onClose:function(){}}),W=["bsPrefix","closeLabel","closeVariant","closeButton","className","children"],Y=l.forwardRef((function(e,s){var t=e.bsPrefix,o=e.closeLabel,r=e.closeVariant,i=e.closeButton,n=e.className,d=e.children,u=(0,T.Z)(e,W);t=(0,O.vE)(t,"toast-header");var c=(0,l.useContext)(q),g=(0,S.Z)((function(e){null==c||null==c.onClose||c.onClose(e)}));return(0,m.jsxs)("div",(0,a.Z)((0,a.Z)({ref:s},u),{},{className:L()(t,n),children:[d,i&&(0,m.jsx)(V.Z,{"aria-label":o,variant:r,onClick:g,"data-dismiss":"toast"})]}))}));Y.displayName="ToastHeader",Y.defaultProps={closeLabel:"Close",closeButton:!0};var $=Y,K=(0,t(6543).Z)("toast-body"),Q=["bsPrefix","className","transition","show","animation","delay","autohide","onClose","bg"],z=l.forwardRef((function(e,s){var t=e.bsPrefix,o=e.className,r=e.transition,i=void 0===r?J:r,n=e.show,d=void 0===n||n,u=e.animation,c=void 0===u||u,g=e.delay,p=void 0===g?5e3:g,h=e.autohide,f=void 0!==h&&h,v=e.onClose,y=e.bg,x=(0,T.Z)(e,Q);t=(0,O.vE)(t,"toast");var I=(0,l.useRef)(p),D=(0,l.useRef)(v);(0,l.useEffect)((function(){I.current=p,D.current=v}),[p,v]);var j=U(),M=!(!f||!d),_=(0,l.useCallback)((function(){M&&(null==D.current||D.current())}),[M]);(0,l.useEffect)((function(){j.set(_,I.current)}),[j,_]);var Z=(0,l.useMemo)((function(){return{onClose:v}}),[v]),C=!(!i||!c),k=(0,m.jsx)("div",(0,a.Z)((0,a.Z)({},x),{},{ref:s,className:L()(t,o,y&&"bg-".concat(y),!C&&(d?"show":"hide")),role:"alert","aria-live":"assertive","aria-atomic":"true"}));return(0,m.jsx)(q.Provider,{value:Z,children:C&&i?(0,m.jsx)(i,{in:d,unmountOnExit:!0,children:k}):k})}));z.displayName="Toast";var G=Object.assign(z,{Body:K,Header:$}),X=function(e){var s=e.message,t=e.myId,a=e.userId,o=e.Date,r=e.MessageId,i=e.deleteMessage;return(0,m.jsxs)("div",{children:[" ",(0,m.jsx)("div",{className:"".concat(I," ").concat(t===a?D:j),children:(0,m.jsx)(G,{className:t===a?M:_,children:(0,m.jsx)(G.Body,{children:(0,m.jsxs)("div",{className:"d-flex d-inline-block",children:[(0,m.jsxs)("big",{children:[s," "]}),(0,m.jsxs)("div",{className:Z,children:[o.Hour,":",o.Minutes]}),(0,m.jsx)(V.Z,{className:C,onClick:function(){i(r)}})]})})})})]})},ee=function(e){var s=e.messages2,t=e.myId,a=e.deleteMessage;return s.map((function(e){return(0,m.jsx)(X,{message:e.message,myId:t,userId:e.userId,Date:e.Date,MessageId:e.id,deleteMessage:a},e.id+e.message)}))},se=t(2506),te=t(1724),ae=t(6670),oe=t(3360),re=t(2592);var ie=t.p+"static/media/send-svg2.bf250e69b5830be8d34d1dd3f2cbf9ac.svg",ne="Dialog_sendSwg__vWWca",le={newMessage:""},de=te.Ry({}),ue=function(e){var s=e.sendMessage,t=e.scrollBottom;return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(se.J9,{initialValues:le,validationSchema:de,onSubmit:function(e,t){var a=t.resetForm;s(e.newMessage),a()},children:function(e){e.handleReset;var s=e.values;return(0,m.jsx)(se.l0,{children:(0,m.jsxs)("div",{className:"d-flex d-inline-block justify-content-center align-items-center",children:[(0,m.jsx)("div",{className:"col-9",children:(0,m.jsx)(ae.rZ,{label:"",name:"newMessage",type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u0448\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",autoFocus:!0})}),(0,m.jsx)("div",{children:(0,m.jsx)(oe.Z,{variant:"light",className:"mx-2",type:"submit",onClick:t,disabled:!s.newMessage,children:(0,m.jsx)(re.Z,{src:ie,className:ne,alt:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",title:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435"})})})]})})}})})},ce=t(9743),ge=t(1087),pe=function(e){var s=e.messages2,t=e.myId,a=e.deleteMessage,o=e.sendMessage,r=e.scrollBottom,i=e.profilePage,n=(0,m.jsx)("div",{className:c,children:i.profile&&(0,m.jsxs)(ge.OL,{to:"/profile/".concat(i.profile.userId),children:[" ",(0,m.jsx)(re.Z,{src:i.profile.photos.small?i.profile.photos.small:h,className:g,title:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u043f\u0440\u043e\u0444\u0438\u043b\u044c",alt:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u043f\u0440\u043e\u0444\u0438\u043b\u044c"}),(0,m.jsx)("span",{className:p,children:i.profile.fullName})]})});return(0,m.jsxs)("div",{className:d,children:[(0,m.jsx)(ce.Z,{children:(0,m.jsx)(ee,{messages2:s,myId:t,deleteMessage:a})}),n,(0,m.jsxs)("div",{className:u,children:[" ",(0,m.jsxs)("div",{children:[(0,m.jsx)(ue,{sendMessage:o,scrollBottom:r})," "]})]})]})},me=function(e){(0,i.Z)(t,e);var s=(0,n.Z)(t);function t(){var e;(0,o.Z)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=s.call.apply(s,[this].concat(r))).sendMessage=function(s){if(e.props.userId){if(s){var t=0,a=0;null!==e.props.profilePage&&(t=e.props.profilePage.profile.fullName,a=e.props.profilePage.profile.photos.small),e.props.sendDialogsThunkCreator(s,e.props.auth.myId,e.props.auth.myLogin,e.props.auth.myProfile.photos.small,e.props.userId),e.props.updateDialogListThunkCreator(e.props.auth.myId,e.props.userId,t,a)}}else alert("\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0438\u0430\u043b\u043e\u0433")},e.deleteMessage=function(s){e.props.deleteMessageThunkCreator(s,e.props.myId,e.props.userId)},e.scrollBottom=function(){var e=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight);window.scrollTo(0,e)},e}return(0,r.Z)(t,[{key:"render",value:function(){return(0,m.jsx)("div",{children:(0,m.jsx)(pe,{messages2:this.props.messages2,myId:this.props.myId,deleteMessage:this.deleteMessage,sendMessage:this.sendMessage,scrollBottom:this.scrollBottom,profilePage:this.props.profilePage})})}}]),t}(l.Component),he=(0,y.qC)((0,v.$j)((function(e){return{myId:e.auth.myId,dialogUserID:e.dialogsPage.dialogUserID,messages2:e.dialogsPage.messages2,profilePage:e.profilePage,auth:e.auth}}),{sendDialogsThunkCreator:f.nB,deleteMessageThunkCreator:f.EF,updateDialogListThunkCreator:f.wB}),x.Z)(me),fe=t(2677),ve=function(e){e.deleteDialog,e.dialogUserID;var s=e.getDialogList,t=(e.dialogs2,e.getDialogLastUpdateTime);return(0,l.useEffect)((function(){var e=setInterval((function(){t(),s()}),1e3);return function(){clearInterval(e)}}),[t,s]),(0,m.jsx)(ce.Z,{children:(0,m.jsxs)(fe.Z,{children:[(0,m.jsx)(he,{})," "]})})},ye=t(8859),xe=t(3990),Ie=function(e){(0,i.Z)(t,e);var s=(0,n.Z)(t);function t(){var e;(0,o.Z)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=s.call.apply(s,[this].concat(r))).commonPartMountUpdate=function(){e.props.userId?e.props.dialogUserID!==e.props.userId&&(e.props.setdialogUserID(e.props.userId),e.props.getProfileThunkCreator(e.props.userId,!0,e.props.myId)):e.props.messages2.length>0&&(e.props.setMessages([]),e.props.setdialogUserID(null))},e.getDialogs=function(){""!==e.props.userId&&e.props.getDialogsThunkCreator(e.props.myId,e.props.userId)},e.getDialogLastUpdateTime=function(){""!==e.props.userId&&e.props.getDialogLastUpdateTimeTnkCrt(e.props.myId,e.props.userId)},e.getDialogList=function(){e.props.getMyDialogListThunkCreator(e.props.myId)},e.deleteDialog=function(s,t){e.props.deleteDialogThunkCreator(s,e.props.myId,t)},e}return(0,r.Z)(t,[{key:"componentDidMount",value:function(){this.getDialogList(),this.commonPartMountUpdate()}},{key:"componentDidUpdate",value:function(e,s,t){this.commonPartMountUpdate(),this.props.dialogLastUpdateTime!==e.dialogLastUpdateTime&&this.getDialogs()}},{key:"render",value:function(){return(0,m.jsx)("div",{children:(0,m.jsx)(ve,(0,a.Z)((0,a.Z)({messages2:this.props.messages2,dialogs:this.props.dialogs,dialogs2:this.props.dialogs2},this.props),{},{getDialogs:this.getDialogs,getDialogLastUpdateTime:this.getDialogLastUpdateTime,myId:this.props.myId,getDialogList:this.getDialogList,dialogUserID:this.props.dialogUserID,deleteDialog:this.deleteDialog}))})}}]),t}(l.Component),De=(0,y.qC)((0,v.$j)((function(e){return{isAuth:e.auth.isAuth,myId:e.auth.myId,dialogUserID:e.dialogsPage.dialogUserID,messages2:e.dialogsPage.messages2,dialogLastUpdateTime:e.dialogsPage.dialogLastUpdateTime,dialogs2:e.dialogsPage.dialogs2,profilePage:e.profilePage,auth:e.auth}}),{getDialogsThunkCreator:f.kp,setdialogUserID:f.Pg,setMessages:f.Z,getDialogLastUpdateTimeTnkCrt:f.kB,getProfileThunkCreator:ye.aI,getFollowThunkCreator:f.fB,getMyDialogListThunkCreator:f.l,deleteDialogThunkCreator:f.LZ}),x.Z,xe.Z)(Ie)}}]);
//# sourceMappingURL=812.46972f73.chunk.js.map