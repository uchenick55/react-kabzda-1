"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[708],{2708:function(e,s,a){a.r(s),a.d(s,{default:function(){return Le}});var t=a(1413),n=a(2791),r=a(8687),d=a(5870),i="dialog2Messages2COM_dialog2Messages2Common__yrugD",o=a(9439),c="dialog2Render_Fixed__yAlTJ",l="dialog2Render_dialog2ListCommon__ZMqFo",g="dialog2Render_MobileDialogWidth__ahAt-",m="dialog2Render_DesktopDialogWidth__zSxVR",u="dialog2Render_Dialog2ItemCardExt__LODJo",h="dialog2Render_Dialog2ItemCardInt__HQqPI",_="dialog2Render_Dialog2ItemCardName__zSixE",M="dialog2Render_Dialog2ItemCardPhoto__jPmgw",x="dialog2Render_Dialog2ItemCardNewMsgCnt__TrWvv",v="dialog2Render_Dialog2ItemCardMsgTime__2bCd+",f="dialog2Render_dialog2HeaderCommon__YO-4Y",p="dialog2Render_Dialog2SearchInput__uF7Sy",j="dialog2Render_MagnifyingGlass__VpERP",N=a(6110),D=a(1087),b=function(e){var s,a=new Date(e?new Date(e).getTime()+108e5:0),t=!!e&&(new Date).getFullYear()===a.getFullYear()&&(new Date).getMonth()===a.getMonth()&&(new Date).getDate()===a.getDate(),n=("0"+a.getFullYear()).substr(-4),r=a.getMonth(),d=("0"+a.getDate()).substr(-2),i=("0"+a.getHours()).substr(-2),o=("0"+a.getMinutes()).substr(-2),c=("0"+a.getSeconds()).substr(-2);switch(r){case 0:s="01";break;case 1:s="02";break;case 2:s="03";break;case 3:s="04";break;case 4:s="05";break;case 5:s="06";break;case 6:s="07";break;case 7:s="08";break;case 8:s="09";break;case 9:s="10";break;case 10:s="11";break;case 11:s="12";break;default:s=""}return{Year:n,Month:s,Day:d,Hour:i,Minutes:o,Seconds:c,isToday:t}},I=a(184),y=function(e){var s=e.userName,a=e.hasNewMessages,t=e.photos,n=e.lastDialogActivityDate,r=e.newMessagesCount,d=e.id,i=b(n);return(0,I.jsx)("div",{className:u,children:(0,I.jsx)(D.OL,{to:"/messages/"+d,children:(0,I.jsxs)("div",{className:h,children:[(0,I.jsx)("div",{className:_,children:s}),"   ",a&&(0,I.jsx)("div",{className:x,children:r})," ",(0,I.jsx)("img",{src:t.small?t.small:N,className:M,alt:"CardPhoto"})," ",(0,I.jsx)("div",{className:v,children:i.isToday?(0,I.jsxs)("span",{children:[" ",i.Hour,":",i.Minutes]}):(0,I.jsxs)("span",{children:[" ",i.Day," ",i.Month," ",i.Year]})})]})})})},R=n.memo(y);var S=a.p+"static/media/magnifying-glass.3e5e2c21301cb96ebac59d5c181f8886.svg",Z=function(e){var s=e.SearchValue,a=e.setSearchValue;return(0,I.jsxs)("div",{children:[(0,I.jsx)("input",{placeholder:"\u041f\u043e\u0438\u0441\u043a",value:s,onChange:function(e){return a(e.target.value)},type:"text",className:p}),(0,I.jsx)("img",{src:S,className:j,alt:"\u041f\u043e\u0438\u0441\u043a"})]})},w=function(e){var s=e.PageWidth,a=e.MobileWidth,t=e.patch,r=e.Dialog2All,d=(0,n.useState)(""),i=(0,o.Z)(d,2),u=i[0],h=i[1],_=r&&r.filter((function(e){return e.userName.toLowerCase().includes(u.toLowerCase())}));return(0,I.jsx)("div",{children:("messages"===t&&s>a||"dialog2"===t)&&(0,I.jsxs)("div",{children:[(0,I.jsx)("div",{className:"".concat(c," ").concat(f," ").concat(s<a?g:m),children:(0,I.jsx)(Z,{SearchValue:u,setSearchValue:h})}),(0,I.jsx)("div",{className:"".concat(c," ").concat(l," ").concat(s<a?g:m),children:_.map((function(e){var s=e.id,a=e.userName,t=e.hasNewMessages,n=e.lastDialogActivityDate,r=e.newMessagesCount,d=e.photos;return(0,I.jsx)(R,{userName:a,hasNewMessages:t,photos:d,lastDialogActivityDate:n,newMessagesCount:r,id:s},s)}))})]})})},k=n.memo(w),A="messages2Render_Fixed__baHQ8",C="messages2Render_messages2NameAndProfileLink__gsVN6",T="messages2Render_messages2ChooseDialog__JKbif",W="messages2Render_messages2RenderMessages__Ebe0U",P="messages2Render_messages2PrintMessage__dhozP",F="messages2Render_MobileMessagesLeft__6JOQ+",L="messages2Render_DesktopMessagesLeft__rsM5T",E="messages2Render_Msg2HeaderName__Mw++x",H="messages2Render_Msg2HeaderPhoto__XGI9W",Y="messages2Render_Msg2HeaderActivityDate__ZWTOr",O="messages2Render_myIdNotMyIdMsg2ComExt__oPyxL",U="messages2Render_myIdMessageExt__41EAp",V="messages2Render_NOTmyIdMessageExt__5fs33",B="messages2Render_myIdNotMyIdMsg2ComInt__Estd7",z="messages2Render_myIdMessageInt__xSaFZ",q="messages2Render_NOTmyIdMessageInt__hPt2K",J="messages2Render_Msg2DropDownMenuExt__az4N7",K="messages2Render_Msg2DropDownMenuIntCommon__vMw3j",Q="messages2Render_Msg2DropDownMenuIntMy__6FgWz",$="messages2Render_Msg2DropDownMenuIntNotMy__Yf+sf",G="messages2Render_Msg2DropDownItems__Qu0q7",X="messages2Render_positionRelative__ovQvp",ee="messages2Render_DropdownItem__AtL0R",se="messages2Render_imgDelete__qGmmU",ae="messages2Render_imgSpam__tMesr",te="messages2Render_imgRestore__YIG+H",ne="messages2Render_Msg2ItemAdedAtCommon__JW5T8",re="messages2Render_ColorMy__HqHhB",de="messages2Render_ColorNotMy__X-mAo",ie="messages2Render_Msg2DeletedText__lBh9V",oe="messages2Render_Msg2DeletedPic__V5oiT",ce="messages2Render_Msg2SpamPic__wTzWN",le="messages2Render_Msg2Body__dWvTp",ge="messages2Render_Msg2DateExt__3e0xK",me="messages2Render_Msg2DateInt__G4Q4g",ue=a(8789);var he=a.p+"static/media/dust-bin2.9f266211d62f71a82d41f9c57beb3d28.svg";var _e=a.p+"static/media/spam1.c38e496626cdf8fb2aae68cddb1227de.svg";var Me=a.p+"static/media/restore1.1c96ab0dd3d42ca07131c5eb6a164a47.svg",xe=function(e){var s=e.Msg2DeleteMessage,a=e.id,t=e.isMyMessage,n=e.Msg2MarkAsSpam,r=e.Msg2Restore,d=e.deletedBySender,i=e.isSpam;return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)("div",{children:(0,I.jsxs)(ue.Z,{children:[(0,I.jsx)(ue.Z.Toggle,{className:"".concat(t?Q:$," \n                         ").concat(K)}),(0,I.jsxs)(ue.Z.Menu,{className:G,children:[!d&&(0,I.jsxs)(ue.Z.Item,{className:X,eventKey:"1",onClick:function(){s(a)},children:[(0,I.jsx)("div",{className:ee,children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0443 \u043c\u0435\u043d\u044f"}),(0,I.jsx)("img",{src:he,className:se,alt:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0443 \u043c\u0435\u043d\u044f"})]}),!t&&!i&&(0,I.jsxs)(ue.Z.Item,{className:X,eventKey:"2",onClick:function(){n(a)},children:[(0,I.jsx)("div",{className:ee,children:"\u0412 \u0441\u043f\u0430\u043c"}),(0,I.jsx)("img",{src:_e,className:ae,alt:"\u0412 \u0441\u043f\u0430\u043c"})]}),(d||i)&&(0,I.jsxs)(ue.Z.Item,{className:X,eventKey:"3",onClick:function(){r(a)},children:[(0,I.jsx)("div",{className:ee,children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c"}),(0,I.jsx)("img",{src:Me,className:te,alt:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c"})]})]})]})})})},ve=function(e){var s=e.id,a=e.body,t=e.Msg2DeleteMessage,r=e.addedAt,d=e.senderId,i=e.myId,c=e.Msg2MarkAsSpam,l=e.Msg2Restore,g=e.deletedBySender,m=e.isSpam,u=e.addedAtPrev,h=b(r),_=b(u),M=i===d,x=(0,n.useState)(""),v=(0,o.Z)(x,2),f=v[0],p=v[1];return(0,I.jsxs)("div",{children:["".concat(h.Day,"-").concat(h.Month,"-").concat(h.Year)!=="".concat(_.Day,"-").concat(_.Month,"-").concat(_.Year)&&(0,I.jsx)("div",{className:ge,children:(0,I.jsxs)("div",{className:me,children:[h.Day,".",h.Month,".",h.Year]})}),(0,I.jsx)("div",{className:"".concat(O," ").concat(M?U:V),children:(0,I.jsxs)("div",{className:"".concat(B," ").concat(M?z:q),onMouseOver:function(){p(s)},onMouseLeave:function(){p("")},children:[g?(0,I.jsxs)("div",{children:[(0,I.jsx)("img",{className:oe,src:he,alt:""}),(0,I.jsx)("div",{className:ie,children:" \u044d\u0442\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u043e"})]}):(0,I.jsx)("div",{className:le,children:a}),(0,I.jsxs)("div",{className:"".concat(ne," ").concat(M?re:de),children:[h.Hour,":",h.Minutes]}),m&&(0,I.jsx)("img",{className:ce,src:_e,alt:""}),(0,I.jsx)("div",{className:J,children:f===s&&(0,I.jsx)(xe,{Msg2DeleteMessage:t,id:s,isMyMessage:M,Msg2MarkAsSpam:c,Msg2Restore:l,deletedBySender:g,isSpam:m})})]})})]})},fe=n.memo(ve),pe=a(5705),je=a(1724),Ne=a(6670),De=a(3360),be=a(2592);var Ie=a.p+"static/media/send-svg2.fca4a68a54e7d25372f7430fe55f0653.svg",ye="Msg2SendMessageRender_sendSwg__etLEs",Re={newMessage:""},Se=je.Ry({}),Ze=function(e){var s=e.Msg2SendMessage;return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(pe.J9,{initialValues:Re,validationSchema:Se,onSubmit:function(e,a){var t=a.resetForm;s(e.newMessage),t()},children:function(e){e.handleReset;var s=e.values;return(0,I.jsx)(pe.l0,{children:(0,I.jsxs)("div",{className:"d-flex d-inline-block justify-content-center align-items-center",children:[(0,I.jsx)("div",{className:"col-9",children:(0,I.jsx)(Ne.rZ,{label:"",autoFocus:!1,name:"newMessage",type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u0448\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",leftLabelLength:""})}),(0,I.jsx)("div",{children:(0,I.jsx)(De.Z,{variant:"light",className:"mx-2",type:"submit",disabled:!s.newMessage,children:(0,I.jsx)(be.Z,{src:Ie,className:ye,alt:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",title:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435"})})})]})})}})})},we=n.memo(Ze),ke=function(e){var s=e.userId,a=e.D2Item,t=a&&a.photos&&a.photos.small?a.photos.small:N,n=b(a&&a.lastUserActivityDate);return(0,I.jsx)("div",{children:a&&(0,I.jsxs)("div",{children:[(0,I.jsx)("div",{className:E,children:a&&a.userName}),(0,I.jsx)(D.OL,{to:"/profile/"+s,children:(0,I.jsx)("img",{className:H,src:t,alt:"photoSrc"})}),(0,I.jsxs)("div",{className:Y,children:["\u0411\u044b\u043b(\u0430): "," ",a&&n.isToday?(0,I.jsxs)("span",{children:[" \u0441\u0435\u0433\u043e\u0434\u043d\u044f \u0432 ",n.Hour,":",n.Minutes]}):(0,I.jsxs)("span",{children:[" ",n.Day,".",n.Month,".",n.Year]})]})]})})},Ae=n.memo(ke),Ce=function(e){var s=e.PageWidth,a=e.MobileWidth,t=e.patch,n=e.MessagesNewerThen,r=e.Msg2DeleteMessage,d=e.Msg2SendMessage,i=e.userId,o=e.D2Item,c=e.myId,l=e.Msg2MarkAsSpam,g=e.Msg2Restore;return(0,I.jsxs)("div",{children:["dialog2"===t&&s>a&&(0,I.jsx)("div",{className:"".concat(A," ").concat(T),children:" \u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0438\u0430\u043b\u043e\u0433"}),"messages"===t&&(0,I.jsxs)("div",{children:[(0,I.jsx)("div",{className:"".concat(A," ").concat(C," ").concat(s<a?F:L),children:(0,I.jsx)(Ae,{userId:i,D2Item:o})}),(0,I.jsxs)("div",{className:"".concat(A," ").concat(W," ").concat(s<a?F:L),children:[n.map((function(e,s,a){var t=e.id,n=e.body,d=e.addedAt,i=e.senderId,o=e.deletedBySender,m=e.isSpam,u=s>0?a[s-1].addedAt:"";return(0,I.jsx)(fe,{id:t,body:n,Msg2DeleteMessage:r,addedAt:d,senderId:i,myId:c,Msg2MarkAsSpam:l,Msg2Restore:g,deletedBySender:o,isSpam:m,addedAtPrev:u},t)})),(0,I.jsx)("div",{className:"second-block"})]}),(0,I.jsx)("div",{className:"".concat(A," ").concat(P," ").concat(s<a?F:L),children:(0,I.jsx)(we,{Msg2SendMessage:d})})]})]})},Te=function(e){var s=e.patch,a=e.PageWidth,t=e.MobileWidth,n=e.Dialog2All,r=e.MessagesNewerThen,d=e.Msg2DeleteMessage,o=e.Msg2SendMessage,c=e.userId,l=e.D2Item,g=e.myId,m=e.Msg2MarkAsSpam,u=e.Msg2Restore;return(0,I.jsxs)("div",{className:i,children:[(0,I.jsx)(k,{PageWidth:a,MobileWidth:t,patch:s,Dialog2All:n}),(0,I.jsx)(Ce,{PageWidth:a,MobileWidth:t,patch:s,MessagesNewerThen:r,Msg2DeleteMessage:d,Msg2SendMessage:o,userId:c,D2Item:l,myId:g,Msg2MarkAsSpam:m,Msg2Restore:u})]})},We=a(7781),Pe=a(1852),Fe=a(3990),Le=(0,We.qC)(Pe.Z,Fe.Z)((function(e){var s=e.userId,a=(0,r.v9)((function(e){return e.dialog2.MessagesNewerThen})),i=(0,r.v9)((function(e){return e.dialog2.Markers})),o=(0,r.v9)((function(e){return e.dialog2.D2Item})),c=(0,r.v9)((function(e){return e.dialog2.Dialog2All})),l=(0,r.v9)((function(e){return e.app.patch})),g=(0,r.v9)((function(e){return e.auth.myId})),m=(0,r.v9)((function(e){return e.app.PageWidth})),u=(0,r.v9)((function(e){return e.app.MobileWidth})),h=d.rP.setMarkers,_=d.rP.setD2Item,M=d.rP.getDialog2AllAC,x=(0,r.I0)(),v=(0,n.useCallback)((function(e){x((0,d.fv)(e,s,"2022-04-30T19:10:31.843",a))}),[s,a,d.fv]),f=document.querySelector(".second-block"),p=(0,n.useCallback)((function(){f&&f.scrollIntoView(!0)}),[f]);return(0,n.useEffect)((function(){o&&o.newMessagesCount>0&&setTimeout((function(){var e=[];c.forEach((function(a){a.id===s&&(a.hasNewMessages=!1,a.newMessagesCount=0),e.push(a)})),console.log("\u0442\u0430\u0439\u043c\u0435\u0440 \u0437\u0430\u043a\u043e\u043d\u0447\u0438\u043b\u0441\u044f"),x(M(e))}),1e3)}),[o,c,M,s]),(0,n.useEffect)((function(){0===s||i.straightFirstUploaded||(console.log("\u043d\u0430\u0447\u0430\u0442\u044c \u0434\u0438\u0430\u043b\u043e\u0433 \u043f\u043e \u043d\u0435\u043f\u0443\u0441\u0442\u043e\u043c\u0443 userId "),x((0,d.H3)(s)),x(h((0,t.Z)((0,t.Z)({},i),{},{straightFirstUploaded:!0}))))}),[s,i,d.H3,h]),(0,n.useEffect)((function(){if(0!==s&&(0===a.length||a.length>0&&a[0].senderId!==s&&a[0].recipientId!==s)){console.log("\u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u043f\u0440\u0438 \u0441\u043c\u0435\u043d\u0435 userId",s),x((0,d.vu)(s,"2022-04-30T19:10:31.843"));var e=c.filter((function(e){return e.id===s}))[0];x(_(e))}}),[s,c,d.vu,_]),(0,n.useEffect)((function(){"dialog2"===l&&!i.Dialog2FirstUploaded&&g&&(console.log("\u0415\u0434\u0438\u043d\u0438\u0447\u043d\u043e\u0435 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0441\u043f\u0438\u0441\u043a\u0430 \u0434\u0438\u0430\u043b\u043e\u0433\u043e\u0432 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435 dialog2"),x((0,d.sz)(g,1,10)),x(h((0,t.Z)((0,t.Z)({},i),{},{Dialog2FirstUploaded:!0}))))}),[s,l,i,d.sz,h,g]),(0,n.useEffect)((function(){i.needToScrollBottom&&(p(),x(h((0,t.Z)((0,t.Z)({},i),{},{needToScrollBottom:!1}))))}),[i,p,h]),(0,I.jsx)("div",{children:(0,I.jsx)(Te,{patch:l,PageWidth:m,MobileWidth:u,Dialog2All:c,MessagesNewerThen:a,Msg2DeleteMessage:v,Msg2SendMessage:function(e){x((0,d.D9)(s,e,"2022-04-30T19:10:31.843",i)),i.dialogId!==s&&(x((0,d.H3)(s)),x(h((0,t.Z)((0,t.Z)({},i),{},{dialogId:s}))))},userId:s,D2Item:o,myId:g,Msg2MarkAsSpam:function(e){x((0,d.ho)(e,a))},Msg2Restore:function(e){x((0,d.HY)(e,a))}})})}))},6670:function(e,s,a){a.d(s,{$m:function(){return M},rZ:function(){return _}});var t=a(1413),n=a(9439),r=a(5987),d=a(5705),i={errorInputTextArea:"formik1_errorInputTextArea__vpmAv",errorText:"formik1_errorText__eDWui",labelWidth:"formik1_labelWidth__cwal9"},o=(a(7632),a(9410)),c=a(5313),l=a(184),g=["label","children"],m=["label","autoFocus","type","leftLabelLength"],u=["children"],h=function(e){e.label;var s=e.children,a=(0,r.Z)(e,g),t=(0,d.U$)(a.props),o=(0,n.Z)(t,1)[0];return(0,l.jsxs)(l.Fragment,{children:[s," ",o.touched&&o.error&&(0,l.jsx)("div",{className:i.errorText,children:o.error})," "]})},_=function(e){var s=e.label,a=e.autoFocus,g=e.type,u=e.leftLabelLength,_=(0,r.Z)(e,m),M=(0,d.U$)(_),x=(0,n.Z)(M,2),v=x[0],f=x[1];return(0,l.jsxs)(h,{label:s,props:_,children:[" ",(0,l.jsxs)(o.Z,{className:"my-1",size:"sm",children:[" ",u&&(0,l.jsxs)(o.Z.Text,{id:s,className:i.labelWidth,style:{width:u},children:[s,":"]}),(0,l.jsx)(c.Z.Control,(0,t.Z)((0,t.Z)((0,t.Z)({as:"textarea"===g?g:"input",type:"password"===g?g:void 0,className:f.touched&&f.error?i.errorInputTextArea:i.inputTextArea},v),_),{},{autoFocus:a}))]}),(0,l.jsx)("div",{className:i.errorText,children:f.touched&&f.error})]})},M=function(e){var s=e.children,a=(0,r.Z)(e,u),o=(0,d.U$)((0,t.Z)((0,t.Z)({},a),{},{type:"checkbox"})),c=(0,n.Z)(o,2),g=c[0],m=c[1];return(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"checkbox-input",children:[(0,l.jsx)("input",(0,t.Z)((0,t.Z)({type:"checkbox"},g),a))," ",s]}),m.touched&&m.error&&(0,l.jsx)("div",{className:i.errorText,children:m.error})]})}},3990:function(e,s,a){var t=a(1413),n=(a(2791),a(8687)),r=a(7689),d=a(184),i=function(e){return{isAuth:e.auth.isAuth}};s.Z=function(e){return(0,n.$j)(i,null)((function(s){return s.isAuth?(0,d.jsx)(e,(0,t.Z)({},s)):(0,d.jsx)(r.Fg,{to:"../login"})}))}},1852:function(e,s,a){var t=a(1413),n=(a(2791),a(7689)),r=a(8687),d=a(184);s.Z=function(e){return(0,r.$j)(null,null)((function(s){var a={params:(0,n.UO)()},r=Number(a.params["*"]);return(0,d.jsx)(e,(0,t.Z)((0,t.Z)({},s),{},{userId:r}))}))}}}]);
//# sourceMappingURL=708.3740b148.chunk.js.map