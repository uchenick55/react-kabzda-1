{"version":3,"file":"static/js/828.8fd15902.chunk.js","mappings":"uMAMMA,EAAqB,WACvBC,QAAQC,IAAI,0BACZ,IAAMC,GAAoCC,EAAAA,EAAAA,KAAa,SAACC,GAAsB,OAAKA,EAAMC,KAAKH,QAAQ,IAatG,IAAMI,EAXN,SAA0BC,GACtB,IAAMD,EAAME,EAAAA,OAA8B,MAO1C,OANAA,EAAAA,WAAiB,WACTF,EAAIG,UACJH,EAAIG,QAAQC,UAAYJ,EAAIG,QAAQE,aAE5C,GAAG,CAACJ,IAEGD,CACX,CAEYM,CAAeV,GAE3B,OAAOW,EAAAA,EAAAA,KAAA,OAAKP,IAAKA,EACLQ,MAAO,CAACC,OAAQ,QAASC,UAAW,QAAQC,SAGnDf,EAASgB,KAAK,SAACC,EAA2BC,GACvC,OAAOP,EAAAA,EAAAA,KAACQ,EAAO,CAAaF,QAASA,GAAhBC,EACzB,KAER,EAEMC,EAAmD,SAAHC,GAAmB,IAAdH,EAAOG,EAAPH,QACvD,OAAON,EAAAA,EAAAA,KAAA,OAAAI,UACHM,EAAAA,EAAAA,MAAA,OAAAN,SAAA,EACIJ,EAAAA,EAAAA,KAAA,OAAKW,IAAKL,EAAQM,MAAOC,IAAI,SAASZ,MAAO,CAACC,OAAQ,UACrDI,EAAQQ,UACTd,EAAAA,EAAAA,KAAA,OAAAI,SAAME,EAAQA,WACdN,EAAAA,EAAAA,KAAA,aAGZ,EAEMe,EAAwB,WAC1B5B,QAAQC,IAAI,6BAEZ,IAAM4B,GAAmC1B,EAAAA,EAAAA,KAAa,SAACC,GAAsB,OAAKA,EAAMC,KAAKwB,aAAa,IAE1GC,GAA8BC,EAAAA,EAAAA,UAAkB,IAAIC,GAAAC,EAAAA,EAAAA,GAAAH,EAAA,GAA7CX,EAAOa,EAAA,GAAEE,EAAUF,EAAA,GACpBG,GAAWC,EAAAA,EAAAA,MAEXC,EAAc,WAChBlB,GAAWgB,GAAUG,EAAAA,EAAAA,IAAiBnB,IACtCA,GAAWe,EAAY,GAC3B,EAQMK,EAA+B,UAAlBV,EACnB,OAAON,EAAAA,EAAAA,MAAA,OAAAN,SAAA,EACHJ,EAAAA,EAAAA,KAAA,SAAO2B,SAAUD,EAAYE,MAAOtB,EAASuB,SAAU,SAACC,GAAC,OAAKT,EAAYS,EAAEC,OAAOH,MAAO,EACnF3B,MAAO,CAAC+B,MAAO,SACfC,WAAY,SAACH,GAAC,OAVC,SAACA,GACJ,KAAfA,EAAEI,UACFV,GAER,CAM8BW,CAAmBL,EAAG,IAC9C,KACF9B,EAAAA,EAAAA,KAAA,UAAQoC,QAASZ,EAAaG,SAAUD,EAAWtB,SAAC,UAAc,MAE1E,EAiBA,EAfuB,WACnBjB,QAAQC,IAAI,cAEZ,IAAMkC,GAAWC,EAAAA,EAAAA,MAOjB,OANAc,EAAAA,EAAAA,YAAW,WAEP,OADAf,GAAUgB,EAAAA,EAAAA,OACH,WACHhB,GAAUiB,EAAAA,EAAAA,MACd,CACJ,GAAG,KACI7B,EAAAA,EAAAA,MAAA,OAAAN,SAAA,EACHJ,EAAAA,EAAAA,KAACd,EAAQ,IAAE,KACXc,EAAAA,EAAAA,KAACe,EAAW,IAAE,MAEtB,EC/EA,EAL+B,WAC3B,OAAOf,EAAAA,EAAAA,KAAA,OAAAI,UACFoC,EAAAA,EAAAA,UAAQ,kBAAIxC,EAAAA,EAAAA,KAACyC,EAAI,GAAE,GAAC,KAE7B,C","sources":["components/Chat/Chat.tsx","components/Chat/ChatContainer.tsx"],"sourcesContent":["import React, {useEffect, useState} from \"react\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {GlobalStateType} from \"../../redux/store-redux\";\nimport {ChannelStatusType, ChatMessagesType} from \"../api/chat-api\";\nimport {sendMessageThCr, startMessagesListening, stopMessagesListening} from \"../../redux/chat-reducer\";\n\nconst Messages: React.FC = () => { // отрисовка всех сообщений\n    console.log(\">>>>>>>>>>>>>>Messages\")\n    const messages: Array<ChatMessagesType> = useSelector( (state: GlobalStateType) => state.chat.messages ) // получить сообщения из стейта\n\n    function useChatScroll<T>(dep: T): React.MutableRefObject<HTMLDivElement | null> {\n        const ref = React.useRef<HTMLDivElement>( null );\n        React.useEffect( () => {\n            if (ref.current) {\n                ref.current.scrollTop = ref.current.scrollHeight;\n            }\n        }, [dep] );\n\n        return ref;\n    }\n\n    const ref = useChatScroll( messages )\n\n    return <div ref={ref}\n                style={{height: \"30rem\", overflowY: \"auto\"}}\n    >\n\n        {messages.map( (message: ChatMessagesType, index: number) => { // пробегаем по списку сообщений из стейта\n            return <Message key={index} message={message}/> // отрисовываем сообщения поэлементно\n        } )}\n    </div>\n}\n\nconst Message: React.FC<{ message: ChatMessagesType }> = ({message}) => { // отрисовка одного сообщения (фото, тела и имени пользователя)\n    return <div>\n        <div>\n            <img src={message.photo} alt=\"avatar\" style={{height: \"30px\"}}/>\n            {message.userName}\n            <div>{message.message}</div>\n            <hr/>\n        </div>\n    </div>\n}\n\nconst AddMessages: React.FC = () => {\n    console.log(\">>>>>>>>>>>>>>AddMessages\")\n\n    const channelStatus: ChannelStatusType = useSelector( (state: GlobalStateType) => state.chat.channelStatus ) // получить статус открытия канала\n\n    const [message, setMessage] = useState<string>( \"\" ) // константа временного хранилища значения поля ввода\n    const dispatch = useDispatch()\n\n    const sendMessage = () => { // колбек отправеки сообщений\n        message && dispatch( sendMessageThCr( message ) ) // отправить сообщение\n        message && setMessage( \"\" ) // занулить поле ввода\n    }\n\n    const checkEnterPressed = (e: React.KeyboardEvent) => { // проверка нажатия Enter\n        if (e.charCode === 13) {\n            sendMessage()\n        }\n    }\n\n    const isDisabled = channelStatus !== \"ready\"\n    return <div>\n        <input disabled={isDisabled} value={message} onChange={(e) => setMessage( e.target.value )}\n               style={{width: \"50rem\"}}\n               onKeyPress={(e) => checkEnterPressed( e )} // проверка нажатия Enter\n        /> {/*поле ввода*/}\n        <button onClick={sendMessage} disabled={isDisabled}>Send </button> {/*отправка сообщений */}\n    </div>\n}\n\nconst Chat: React.FC = () => {\n    console.log(\">>>>>>Chat\")\n\n    const dispatch = useDispatch()\n    useEffect( () => {\n        dispatch( startMessagesListening() )// открытие канала WS, создание подписок и слушателей событий\n        return () => {\n            dispatch( stopMessagesListening() ) // закрытие канала WS, удаление подписок и слушателей событий\n        }\n    }, [] )\n    return <div>\n        <Messages/> {/*отрисовка сообщений*/}\n        <AddMessages/> {/*ввод сообщений и кнопка отправки*/}\n    </div>\n}\nexport default Chat\n","import React, {useMemo} from \"react\";\nimport Chat from \"./Chat\";\n\nconst ChatContainer:React.FC = () => {\n    return <div>\n        {useMemo(()=><Chat/>,[])}\n    </div>\n}\nexport default ChatContainer\n"],"names":["Messages","console","log","messages","useSelector","state","chat","ref","dep","React","current","scrollTop","scrollHeight","useChatScroll","_jsx","style","height","overflowY","children","map","message","index","Message","_ref","_jsxs","src","photo","alt","userName","AddMessages","channelStatus","_useState","useState","_useState2","_slicedToArray","setMessage","dispatch","useDispatch","sendMessage","sendMessageThCr","isDisabled","disabled","value","onChange","e","target","width","onKeyPress","charCode","checkEnterPressed","onClick","useEffect","startMessagesListening","stopMessagesListening","useMemo","Chat"],"sourceRoot":""}